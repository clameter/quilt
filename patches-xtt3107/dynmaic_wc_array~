Index: rdma-core/ib2roce/ib2roce.c
===================================================================
--- rdma-core.orig/ib2roce/ib2roce.c
+++ rdma-core/ib2roce/ib2roce.c
@@ -180,6 +180,8 @@ static const char *stats_text[nr_stats]
 	"LeaveRequests"
 };
 
+unsigned max_wc_cqs = 1000;
+
 static int cq_high = 0;	/* Largest batch of CQs encountered */
 
 enum channel_type { channel_rdmacm, channel_ud, channel_qp1,
@@ -1077,7 +1079,7 @@ static void *busyloop(void *private)
 	struct core_info *core = private;
 	int cqs;
 	int i;
-	struct ibv_wc wc[100];
+	struct ibv_wc wc[max_wc_cqs];
 
 	pthread_setcanceltype(PTHREAD_CANCEL_ASYNCHRONOUS, NULL);
 
@@ -1092,7 +1094,7 @@ loop:
 	cpu_relax();
 	/* Scan CQs */
 	for(i = 0; i < core->nr_channels; i++) {
-		cqs = ibv_poll_cq(core->cq[i], 100, wc);
+		cqs = ibv_poll_cq(core->cq[i], max_wc_cqs, wc);
 		if (cqs)
 			goto process_cq;
 	}
@@ -3820,7 +3822,7 @@ static void handle_comp_event(void *priv
 	struct rdma_channel *c;
 	struct ibv_cq *cq;
 	int cqs;
-	struct ibv_wc wc[100];
+	struct ibv_wc wc[max_wc_cqs];
 
 	ibv_get_cq_event(events, &cq, (void **)&c);
 
@@ -3831,7 +3833,7 @@ static void handle_comp_event(void *priv
 	}
 
 	/* Retrieve completion events and process incoming data */
-	cqs = ibv_poll_cq(cq, 100, wc);
+	cqs = ibv_poll_cq(cq, max_wc_cqs, wc);
 	if (cqs < 0) {
 		logg(LOG_WARNING, "CQ polling failed with: %s on %s\n",
 			errname(), c->text);
