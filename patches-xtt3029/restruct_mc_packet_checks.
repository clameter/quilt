Index: rdma-core/ib2roce/ib2roce.c
===================================================================
--- rdma-core.orig/ib2roce/ib2roce.c
+++ rdma-core/ib2roce/ib2roce.c
@@ -3945,6 +3945,7 @@ static void receive_multicast(struct buf
 	struct ib_addr *dgid = (struct ib_addr *)&buf->grh.dgid.raw;
 	struct in_addr dest_addr;
 	int ret;
+	const char *reason = NULL;
 
 #ifdef UNICAST
 	learn_source_address(buf);
@@ -3956,9 +3957,19 @@ static void receive_multicast(struct buf
 		goto invalid_packet;
 	}
 
-	if ((buf->ip_valid && !IN_MULTICAST(ntohl(buf->ip.daddr))) || (!buf->ip_valid && buf->grh.dgid.raw[0] !=  0xff)) {
-		logg(LOG_WARNING, "Unicast Packet on multicast channel %s: GRH=%s %s\n", c->text, grh_str(&buf->grh), payload_dump(buf->cur));
-		goto invalid_packet;
+	if (buf->ip_valid) {
+
+		if (!IN_MULTICAST(ntohl(buf->ip.daddr))) {
+			reason = "Unicast Packet";
+			goto discardit;
+		}
+
+	} else /* ! buf->ip_valid */ {
+
+		if (buf->grh.dgid.raw[0] !=  0xff) {
+			reason = "Unicast Packet";
+			goto discardit;
+		}
 	}
 
 	dest_addr.s_addr = dgid->sib_addr32[3];
@@ -4085,6 +4096,9 @@ delayed_packet:
 	st(c, packets_bridged);
 	return;
 
+discardit:    
+	logg(LOG_WARNING, "%s on multicast channel %s: GRH=%s %s\n", reason, c->text, grh_str(&buf->grh), payload_dump(buf->cur));
+
 invalid_packet:
 	st(c, packets_invalid);
 }
