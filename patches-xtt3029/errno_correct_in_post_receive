Index: rdma-core/ib2roce/ib2roce.c
===================================================================
--- rdma-core.orig/ib2roce/ib2roce.c
+++ rdma-core/ib2roce/ib2roce.c
@@ -1549,6 +1549,7 @@ static void post_receive(struct rdma_cha
 		ret = ibv_post_recv(c->qp, &recv_wr, &recv_failure);
 		if (ret) {
 			free_buffer(buf);
+			errno = ret;
 			logg(LOG_WARNING, "ibv_post_recv failed: %s:%s\n", c->text, errname());
 			return;
                 }
